---
slug: git-auto-commit
description: "git statusとdiffを解析し、Convoy標準に沿って適切なブランチ作成・粒度の細かいコミット・マージを自動化します"
trigger: model_decision
---

# 🤖 Git 自動コミットワークフロー (V4.2 Lite)

このワークフローは、変更内容を解析して適切な粒度でコミットを行い、Convoy（Mission Control）の運用品質を安定させます。

## Step 1: 🔍 状態確認 // turbo
以下のコマンドを順に実行して、現在の変更状態を確認してください。**コマンドはセミコロンで連結せず、必ず1つずつ実行してください。**

1. ステータスの確認
   ```bash
   git status
   ```

2. 差分の統計確認
   ```bash
   git --no-pager diff --stat
   ```

## Step 2: 🌿 develop ブランチの準備 // turbo

> Note: リポジトリ運用が `main` 直下（trunk-based）で `develop` を使わない場合は、`develop` を `main` に読み替えて同様に進めます。
1. `develop` ブランチが存在するか確認します。
2. 存在しない場合は作成し、プッシュします。
3. 存在する場合はチェックアウトし、`git pull origin develop` で最新化します。

## Step 3: 🌿 作業用ブランチの作成 // turbo
- 変更内容に基づき、適切な英語のブランチ名を提案・作成します。
  - 命名規則: `feature/[機能名]-[日付]`
  - 例: `feature/update-readme-alerts-20251227`
  - **Issue番号は含めないでください**。

## Step 4: 💻 粒度の細かいコミット // turbo

- **注意**: `COMMIT_MSG.txt` はコミット対象に含めません。作業後は削除するか、必要なら `.gitignore` に追加します。
- `git diff` の内容を分析し、**作業の単位ごとに細かく分割してコミット**します。
- **コミットメッセージのルール**:
  - **Type（型）**: 以下のリストから適切なものを選んでください。
    - `feat`: 新機能
    - `fix`: バグ修正
    - `docs`: ドキュメントの変更
    - `style`: コードスタイルの変更（動作に影響しない）
    - `refactor`: リファクタリング
    - `perf`: パフォーマンス改善
    - `test`: テストの追加・修正
    - `chore`: ビルドプロセスやツールの変更
  - **必ず日本語**で記述すること。（英語の思考であっても、最終的なコミットメッセージは必ず日本語にすること）
  - **絵文字**をプレフィックスとして付与すること。
  - **3行程度の箇条書き**で詳細を含めること。
  - **良いコミットメッセージの例**:
    - `feat` (新機能):
      ```text
      ✨ feat: ユーザーログイン機能の実装

      - ログインフォームのUIコンポーネントを作成
      - メールアドレスとパスワードのバリデーションロジックを追加
      - 認証APIとの連携処理を実装
      ```
    - `fix` (バグ修正):
      ```text
      🐛 fix: ヘッダー画像のレスポンシブ崩れを修正

      - モバイル画面での高さを `auto` に変更
      - フレックスボックスの配置設定を調整
      - 不要なマージンを削除
      ```
    - `docs` (ドキュメント):
      ```text
      📝 docs: インストール手順の更新

      - Node.jsの推奨バージョンをv20に更新
      - 環境変数の設定例 `.env.example` を追加
      - トラブルシューティングの項目を追記
      ```
  - **コミットメッセージの取り扱い**:
    - **一時ファイル（`COMMIT_MSG.txt`）** にメッセージ内容を作成してからコミットしてください。
    - エディタ/自動化ツールを使用してファイルを作成・更新します（環境に `write_to_file` がある場合は使用可）。
    - `-F` オプションを使用してファイルを指定します。
  - コマンド例:
    ```bash
    git add [ファイルA]
    ```
    ```bash
    git commit -F COMMIT_MSG.txt
    ```

## Step 5: 🔍 コミット確認 // turbo
- 全ての変更がコミットされたか確認します。
  ```bash
  git status
  ```

## Step 6: 🔄 develop へのマージ // turbo
1. `develop` ブランチに切り替えます。
2. `COMMIT_MSG.txt` にマージメッセージを作成します。
3. `--no-ff` オプションと `-F` オプションを付けてマージします。
   ```bash
   git merge --no-ff feature/[ブランチ名] -F COMMIT_MSG.txt
   ```
3. リモートへプッシュします。

## Step 7: 🗑️ 作業ブランチの削除 // turbo
- マージ済みの作業ブランチを削除します。
  ```bash
  git branch -d feature/[ブランチ名]
  ```

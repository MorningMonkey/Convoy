---
slug: "ui-verification"
description: "ローカル（または指定URL）のUIをブラウザ操作で視覚検証し、スクリーンショットとコンソール所見を根拠にPASS/FAILを報告する。スタック/ポートはSoT（brief.md）を優先する。"
trigger: "manual"
---
# 🖥️ ui-verification — UI検証

このワークフローは、単体テストだけでは拾いづらい **レイアウト崩れ・ルーティング欠落・実行時エラー** を、ブラウザ操作で検証します。  
Convoy では「見た目がOK」ではなく、**根拠（スクリーンショット/コンソール所見）**を残して PASS/FAIL を判定します。

---

## 定義（このワークフローの狙い）
- UIが正常に表示されること（初期表示）
- 主要導線が破綻していないこと（ナビゲーション/主要操作）
- 実行時エラーが出ていないこと（コンソール）
- 代表的なビューポートで致命的な崩れがないこと（レスポンシブ）

---

## SoT（Source of Truth）
- プロダクト要件/対象プラットフォーム: `assets/branding/<productId>/brief.md`
- 利用可能コマンド一覧: `.agent/INDEX.md`
- 管制仕様: `ANTIGRAVITY_AGENT_CONTROL_SPEC.md`
- UI/UXルール（任意）: `.agent/rules/*.md`

---

## 入力（Inputs）
- 対象URL（任意）
  - 既定: `http://localhost:<port>`
- 代表画面/シナリオ（任意）
  - 例: ログイン→一覧→詳細→保存
- 認証情報（任意・慎重に）
  - 原則: テスト用アカウントのみ（本番アカウントは使用しない）

---

## 成果物（Outputs）
- 判定: `PASS` / `FAIL`
- スクリーンショット（推奨: `artifacts/ui-verification/<timestamp>/...`）
- コンソール所見（エラー/警告の件数と代表例）
- 主要導線の検証結果（OK/NG/N/A）
- 不具合があれば再現手順（最小）

---

## 安全ガード（Convoy標準）
- 破壊的操作は禁止（削除/課金/外部書き込み等）
- 重要操作（購入/送信/削除/本番デプロイ）は **実行しない**
- 認証が必要な操作は、テスト環境・テストアカウントのみ
- スクリーンショットには秘密情報が映らないよう配慮（必要ならマスク）

---

# 手順

## Step 1: 開発サーバー起動（SoT優先） // turbo
`brief.md` に起動コマンドがあればそれを最優先。なければ以下をフォールバック。

### 例（Node/Web）
```bash
pnpm dev || npm start || yarn dev
```

### 例（Flutter Webの場合）
```bash
flutter run -d chrome
```

**チェック**
- 起動ログにポート/URLが表示されているか
- 起動に失敗した場合はログ要約して停止

---

## Step 2: アクセスURLの確定（port決め）
既定は `http://localhost:3000`。  
ただし、起動ログ/brief.md に従って `localhost:<port>` を確定する。

**出力（必須）**
- 対象URL（確定値）

---

## Step 3: ブラウザでアクセス（視覚検証）
Browser Subagent（ブラウザ操作ツール）で対象URLへアクセスする。

確認項目：
- 画面がレンダリングされる（白画面/エラーページではない）
- 主要コンテナ（header/nav/main/footer など）が崩れていない
- 初期ロードで致命的なエラー表示がない

**スクリーンショット**
- `01-initial.png`

---

## Step 4: 初期表示チェック（Console/Network）
ブラウザで以下を確認する：

- コンソールエラー（赤）が出ていないか
- 404（主要JS/CSS/ルート）が出ていないか
- 無限リロード/無限スピナーがないか

**出力（必須）**
- Console: error/warn の件数（代表例最大3件）
- Network: 404/500 の有無

---

## Step 5: 主要導線のインタラクション検証
プロダクトの “MVP導線” を中心に、次を実行する。  
該当しない項目は N/A とする。

### 5.1 ナビゲーション（必須）
- 主要リンク/タブをクリック
- ルーティングが成立する（404/空画面にならない）
- 戻る/進むが破綻しない（可能なら）

**スクリーンショット**
- `02-nav-1.png`, `03-nav-2.png`（主要ページ分）

### 5.2 フォーム（任意）
- 入力→バリデーション→送信（送信は安全な範囲で）
- エラーメッセージの表示が適切
- 二重送信やフリーズがない

**スクリーンショット**
- `04-form.png`

### 5.3 モーダル/ダイアログ（任意）
- 開く→内容確認→閉じる
- ESC/外側クリックの挙動（仕様にある場合）

**スクリーンショット**
- `05-modal-open.png`, `06-modal-close.png`

---

## Step 6: レスポンシブ検証（推奨）
ビューポートを切り替え、致命的な崩れがないか確認する。

| Profile | Width | 目的 |
|---|---:|---|
| Mobile | 375 | 片手UI/折返し/タップ領域 |
| Tablet | 768 | 2カラム化/余白の破綻 |
| Desktop | 1280 | 最大幅/中央寄せ/余白 |

**スクリーンショット**
- `10-mobile.png`, `11-tablet.png`, `12-desktop.png`

> 既に「iPhone16 W393×H852」を標準としている場合は、その値を最優先（SoTに従う）。

---

## Step 7: 判定条件（Assert）
以下のいずれかがあれば `FAIL`：

- 初期表示が成立しない（白画面/エラーページ）
- 主要導線で 404 / 500 / 例外が発生
- コンソールに “致命的” エラー（Unhandled exception等）が継続的に出る
- 重要UI要素が欠落（操作不能）
- レスポンシブで主要操作が不能（ボタンが画面外、入力不可 など）

それ以外は原則 `PASS`（警告は所見として残す）。

---

## Step 8: レポート生成（Convoy標準）
```markdown
## 🖥️ UI検証レポート

- 検証日時: <timestamp>
- 対象URL: <url>
- 実行環境: <OS/Browser（分かる範囲で）>

### 結果サマリー
- 初期表示: ✅ OK / ❌ NG
- ナビゲーション: ✅ OK / ❌ NG
- フォーム: ✅ OK / ❌ NG / ➖ N/A
- モーダル: ✅ OK / ❌ NG / ➖ N/A
- レスポンシブ: ✅ OK / ❌ NG / ➖ N/A

### Console / Network
- Console error: <N>（代表: 最大3件）
- Console warn: <N>（代表: 最大3件）
- Network 404/500: <有/無>（代表: 最大3件）

### スクリーンショット
- artifacts/ui-verification/<timestamp>/01-initial.png
- artifacts/ui-verification/<timestamp>/02-nav-1.png
- ...

### 総合判定
✅ PASS / ❌ FAIL

### Action（FAIL時）
- 再現手順（最小）:
  1) ...
- 期待動作:
- 観測結果:
- 推奨修正:
```

---

## Step 9: クリーンアップ（任意） // turbo
必要に応じて開発サーバーを停止する。  
（サーバー停止が必要な場合は、実行環境に応じた手順を用いる）


